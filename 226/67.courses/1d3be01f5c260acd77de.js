webpackJsonp([67],{169:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i,n){for(var a=new PIXI.Container,o=new PIXI.filters.ColorMatrixFilter,r=i||!1,h=n||{addArrow:!1,type:"horizontal",scale:1},l=new PIXI.Container,s=0;s<3;++s){var d=s+1,c=PIXI.Sprite.fromFrame("TAP_1"+d);c.x=-c.width/2,c.y=-c.height/2;var v=new PIXI.Container;v.addChild(c),l.addChild(v)}var u=0;if(h.direction)switch(h.direction){case"top":u=-Math.PI/2;break;case"bottom":u=Math.PI/2;break;case"left":u=Math.PI;break;case"right":u=0;break;default:u=0}l.filters=[o];for(var f=0;f<l.children.length;f++){var g=l.children[f];g.scale.x=g.scale.y=2,f<2&&I(g,.75*f)}if(a.addChild(l),h.addArrow){var x,p;if(h.direction){x=PIXI.Sprite.fromFrame("oneArrow"),p=new PIXI.extras.MovieClip([x]);var m=h.scale?h.scale:1;p.scale.x=p.scale.y=m,p.pivot={x:0,y:p.height/2},p.rotation=u}else{x=PIXI.Sprite.fromFrame("NBarrow"),(p=new PIXI.extras.MovieClip([x])).pivot={x:p.width/2,y:p.height/2};var _=h.scale?h.scale:1;p.scale.x=p.scale.y=_,"horizontal"!==(h.type?h.type:"horizontal")&&(p.rotation=Math.PI/2)}a.addChild(p),a.arrow=p,a.addEventListener("hideArrow",function(){p.alpha=0,p.visible=!1}),a.addEventListener("showArrow",function(){p.alpha=1,p.visible=!0})}l.alpha=.4;var T=new PIXI.Graphics;function I(e,t){TweenMax.to(e,1.5,{delay:t,alpha:0,repeat:-1}),TweenMax.to(e.scale,1.5,{x:5,y:5,delay:t,repeat:-1})}return T.beginFill(16776960,0),T.drawRect(-50,-50,100,100),a.addChild(T),a.addEventListener(MouseEvent.MOUSE_OVER,function(){l.alpha=.6}),a.addEventListener(MouseEvent.MOUSE_OUT,function(){l.alpha=.4}),a.addEventListener(TouchEvent.TOUCH_BEGIN,function(){a.emit(a.event.TAP),!r&&a.parent&&a.parent.removeChild(a)}),a.x=e,a.y=t,a.setColor=function(e){var t=e>>16,i=e>>8&255,n=255&e;o._loadMatrix([t,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,255,0],!1),l.filters=[o]},a.setRotation=function(e){a.rotation=e},a.showAllDir=function(){if(h.direction)for(var e=0;e<3;e++){var t=new PIXI.Container;t.addChild(PIXI.Sprite.fromFrame("oneArrow")),a.addChild(t),t.pivot={x:0,y:p.height/2},t.rotation=Math.PI/2*(e+1)}else{var i=new PIXI.Container;i.addChild(PIXI.Sprite.fromFrame("NBarrow")),a.addChild(i),i.pivot={x:p.width/2,y:p.height/2},i.rotation=a.rotation+Math.PI/2}},a.event={TAP:"pointTap",HIDEARR:"hideArrow",SHOWARR:"showArrow"},instance.info&&instance.info.newLayOut&&a.scale.set(.6,.6),a}},464:function(e,t,i){"use strict";var n=r(i(537)),a=r(i(551)),o=r(i(169));function r(e){return e&&e.__esModule?e:{default:e}}nb.substance0644=extendsClass(ScienceMain,{frame0:function(){for(var e={x:640,y:360},t={lockScale:!0,minScale:.2,hornSize:20},i={TOTOP:"LeveType.TOTOP",TOBOTTOM:"LeveType.TOBOTTOM"},r=[{r:1,g:1,b:1},{r:3.5,g:1.1,b:0},{r:15,g:0,b:0},{r:0,g:0,b:15},{r:0,g:0,b:0}],h=this,l=h.leaf0,s=h.switchs,d=h.page0,c=h.page1,v=h.page2,u=h.page3,f=h.plate,g=h.background,x=h.leveBtn,p=h.delBtn,m=h.colorBtn,_=h.lineBox,T=null,I=0,y=[],E=[d,c,v,u],w=0;w<E.length;w++)y[w]=[];var P=[];n.default.bind(s,E,{isLoop:!0});var O=f.width,C=f.height,b=f.x,N=f.y,A=O/6,M=C/8;_.width=2*A-10,_.height=2*M-10,_.visible=!1,_.alpha=.8;for(var B=0;B<12;B++){var S=B%3,L=B/3>>0,k=h["leaf"+B];k.x=b+A*(2*S+1),k.y=N+M*(2*L+1),k.addEventListener(TouchEvent.TAP,F)}g.alpha=0,g.addEventListener(TouchEvent.TAP,function(){G(null)});var D=(0,o.default)(0,0);function F(){instance.NBDownTip.hideTip(),l.removeChild(D);var i=this.name,n=this.clone();n.name=i+"clone",this.name=i,h.addChildAt(n,R()),n.x=e.x,n.y=e.y,n.scale.x=n.scale.y=1,n.from=this,n.addEventListener(a.default.event.ON_FOUCE,G),n.addEventListener(a.default.event.ON_CHANGE,H);var o=n.children[0].clone();o.alpha=.2,n.addChild(o);var r=new a.default(n,t);G(r),n.leafEdit=r,y[I].push(n),n.colorIndex=0,X()}function G(e){T&&T!==e&&T.unFouce(),e&&J(!0,[x,p,m]),T=e,function(){if(T){var e=T.getImageBox().from,t=e.x,i=e.y;_.x=t,_.y=i,_.visible=!0}else _.visible=!1}(),X()}function H(){var e=this.children[0],t=this.children[1];t.width=e.width,t.height=e.height,t.x=e.x,t.y=e.y}function X(){if(T){var e=R(),t=T.getImageBox();e!==h.getChildIndex(T.getImageBox())?(x.txt.text="移至顶层",x.btnType=i.TOTOP):(x.txt.text="移至底层",x.btnType=i.TOBOTTOM),y[I].length<=1?(x.alpha=.5,x.interactive=!1):(x.alpha=1,x.interactive=!0),J(!1);var n=t.colorIndex;m.icon.gotoAndStop(n)}else J(!1,[x,p,m].concat(P))}function R(){return h.getChildIndex(s)-1}function U(){h.addChildAt(T.getImageBox(),x.btnType===i.TOTOP?R():1),X()}function W(){var e=T.getImageBox();T.unFouce(),T.destroy(),h.removeChild(e),y[I].splice(y[I].indexOf(e),1),G(T=null),X()}function j(e){T&&(T.unFouce(),G(null),X()),y[I].forEach(function(e){e.visible=!1}),y[e].forEach(function(e){e.visible=!0}),I=e}function z(){J(!0)}function V(){var e=T.getImageBox(),t=e.children[0],i=this.name.substr(-1)<<0,n=r[i],a=n.r,o=n.g,h=n.b,l=new PIXI.filters.ColorMatrixFilter;l._loadMatrix([a,0,0,0,0,0,o,0,0,0,0,0,h,0,0,0,0,0,1,0],!1),t.filters=[l],e.colorIndex=i,X()}function J(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:P).forEach(function(t){t.visible=e})}D.scale.x=D.scale.y=2,l.addChild(D),instance.NBDownTip.showTip("请点击选择你需要的树叶完成叶画"),function(){x.addEventListener(TouchEvent.TAP,U),p.addEventListener(TouchEvent.TAP,W),m.addEventListener(TouchEvent.TAP,z);for(var e=0;e<5;e++){var t=h["color"+e];P.push(t),t.addEventListener(TouchEvent.TAP,V)}s.addEventListener(n.default.event.ON_CHANGE,j),X(),J(!1)}()},start:function(){this.bindScriptToSprite(this.frame0,"frame0")},info:{experimentImport:"叶子缤纷多彩，姿态万千，我们一起用不同的叶子来作画吧。",labName:"做叶画",newLayOut:!0,isOffset:!0},const:{},event:{}}),e.exports=nb.substance0644},537:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={event:{ON_INIT:"switchPages.event.ON_INIT",ON_CHANGE:"switchPages.event.ON_CHANGE",ON_TAP:"switchPages.event.ON_TAP",ON_MOVING:"switchPages.event.ON_MOVING"}},a={isLoop:!1,speed:1,autoTime:0};n.bind=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&e.pageMask){var o=!0;if(t.forEach(function(e,t){if(!e)return o=!1,void console.error("pages["+t+"]不合法")}),o){var r=Object.assign(a,i);!function(){var i=e.last,a=e.next,o=e.pageMask,s=e._switchPagesMaskW=o.width;t.forEach(function(t,i){e.addChildAt(t,0),t.x=0===i?0:s,t.y=0,t.mask=o.children[0]}),e._pageIndex=0,i&&i.addEventListener(TouchEvent.TAP,function(){e.emit(n.event.ON_TAP,-1),h(-1)});a&&a.addEventListener(TouchEvent.TAP,function(){e.emit(n.event.ON_TAP,1),h(1)});e.isChangeAble=!0,r.autoTime&&h(0);l(!0),e.emit(n.event.ON_INIT)}(),e.setIndex=function(t,i){var n=t-e._pageIndex;return n&&h(n,i),e},e.setAutoTime=function(t){return r.autoTime=t,clearTimeout(e.autoTimer),t&&(e.autoTimer=setTimeout(function(){h(1)},1e3*r.autoTime)),e}}}else console.error("请正确传入和配置组件");function h(i,a){if(e.isChangeAble){var o=t.length;if(r.isLoop||!(e._pageIndex+i<0||e._pageIndex+i>=o)){var s=(e._pageIndex+o+i)%o,d=t[s],c=t[e._pageIndex],v=e._switchPagesMaskW,u=new TimelineMax({onStart:function(){l(!1)},onComplete:function(){e._pageIndex=s,e.emit(n.event.ON_CHANGE,e._pageIndex),l(!0),r.autoTime&&(e.autoTimer&&(clearTimeout(e.autoTimer),e.autoTimer=null),e.autoTimer=setTimeout(function(){h(1)},1e3*r.autoTime))}}),f=r.speed||1;d.parent.addChild(d);var g=void 0!==a?a:.4/f;i<0?(d.x=-v,u.to([d,c],g,{x:"+="+v})):(d.x=v,u.to([d,c],g,{x:"-="+v}))}}}function l(i){e.isChangeAble=i,e.emit(n.event.ON_MOVING,i);var a=e.last,o=e.next;if(i){if(r.isLoop)return s(a,!0),void s(o,!0);var h=t.length,l=e._pageIndex;s(a,l>0),s(o,l<h-1)}else s(a,!1),s(o,!1);function s(e,t){e&&(e.interactive=t,e.alpha=t?1:.5)}}},t.default=n},551:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n={hornSize:30,hornColor:0,hornAlpha:1,lineColor:16777215,lineAlpha:1,lineWidth:2,minScale:.5,maxScale:3,lockScale:!1,dragable:!0,rotationBarHeight:50,adsorbentRotations:[0,Math.PI/2,Math.PI,1.5*Math.PI,2*Math.PI],adsorbentThreshold:5*Math.PI/180};this.imageBox=t,this.config=Object.assign(n,i),this.editor=this.__constructionEditor(t),this.imageBox.addChild(this.editor),this.isFouce=!0,this.config.dragable&&NBDrag.addDrag(t),t.root=this,t.addEventListener(TouchEvent.TOUCH_BEGIN,this.__onFouce),this.render()}return n(e,[{key:"getEditor",value:function(){return this.editor}},{key:"__constructionEditor",value:function(e){if(!this.editor){var t=e.children[0],i=t.width,n=t.height;e.defaultW=i,e.defaultH=n;var a=this.config,o=a.lineWidth,r=a.lineColor,h=a.lineAlpha,l=a.hornSize,s=a.hornAlphaColor,d=a.hornAlpha,c=a.rotationBarHeight,v=(a.dragable,new PIXI.Container),u=new PIXI.Graphics;u.lineStyle(o,r,h),v.addChild(u),v.frame=u;for(var f=0;f<4;f++){var g=new PIXI.Graphics;g.lineStyle(o,r,h),g.beginFill(s,d);var x=l/2;g.drawRect(-x,-x,l,l),g.endFill(),v[g.name="horn"+f]=g,g.root=this,NBDrag.addDrag(g),g.addEventListener(NBDrag.event.DRAG_MOVE,this.__hornDrag),g.addEventListener(NBDrag.event.STOP_DRAG,this.__hornDragEnd),v.addChild(g)}var p=c,m=new PIXI.Graphics;m.lineStyle(o,r,h);var _=l/2;return m.moveTo(0,0),m.lineTo(0,-p),m.beginFill(s,d),m.drawCircle(0,-p,_),m.endFill(),m.x=0,m.y=e.children[0].y,v.addChild(m),v.rotationBar=m,m.root=this,m.addEventListener(TouchEvent.TOUCH_BEGIN,this.__rotationStart),m.addEventListener(TouchEvent.TOUCH_MOVE,this.__rotationMove),m.addEventListener(TouchEvent.TOUCH_END,this.__rotationEnd),m.addEventListener(TouchEvent.TOUCH_END_OUDSIDE,this.__rotationEnd),v}}},{key:"render",value:function(){var e=this.imageBox,t=this.editor,i=e.children[0],n=i.x,a=i.y,o=i.width,r=i.height,h=t.frame,l=t.rotationBar,s=this.config,d=s.lineWidth,c=s.lineColor,v=s.lineAlpha;s.minScale;h.clear(),h.beginFill(c,0),h.lineStyle(d,c,v),h.drawRect(n,a,o,r),h.endFill();for(var u=0;u<4;u++){var f=u%2,g=u/2>>0,x=t["horn"+u];x.x=f*o+n,x.y=g*r+a}l.x=0,l.y=a}},{key:"__hornDrag",value:function(){var t=this.root;if(this.lastPoint){var i=this.x-this.lastPoint.x,n=this.y-this.lastPoint.y,a=t.imageBox,o=t.imageBox.children[0],r=o.height,h=o.width,l=this.name.substr(-1)>>0,s=Math.pow(-1,l%2+1),d=Math.pow(-1,1+(l/2>>0)),c=r+d*n*2,v=h+s*i*2,u=t.config,f=u.minScale,g=u.maxScale,x=u.lockScale,p=a.defaultH,m=a.defaultW,_=v/m,T=c/p;if(this.root.__dragSwitch(!1),x){T<=f?T=f:T>=g&&(T=g);var I=((o.height=p*T)-r)/2,y=((o.width=m*T)-h)/2;o.x-=y,o.y-=I;var E=o.x,w=o.y,P=o.width,O=o.height,C=l%2,b=l/2>>0;this.lastPoint.x=C*P+E,this.lastPoint.y=b*O+w}else T>f&&T<g?(o.height=c,o.y-=d*n,this.lastPoint.y=this.y):this.y=this.lastPoint.y,_>f&&_<g?(o.width=v,o.x-=s*i,this.lastPoint.x=this.x):this.x=this.lastPoint.x;t.render(),this.root.imageBox.emit(e.event.ON_CHANGE,this.root)}else this.lastPoint={x:this.x,y:this.y}}},{key:"__hornDragEnd",value:function(){this.lastPoint=null,this.root.__dragSwitch(!0)}},{key:"__rotationStart",value:function(){this.isRotation=!0}},{key:"__rotationMove",value:function(e){if(this.isRotation){this.root.__dragSwitch(!1);var t=e.data.global,i=this.root.imageBox.toGlobal(new PIXI.Point),n=Math.atan2(t.x-i.x,t.y-i.y);this.root.imageBox.rotation=-n+Math.PI}}},{key:"__rotationEnd",value:function(){var e=this.root;e.__dragSwitch(!0),this.isRotation=!1;for(var t=e.imageBox,i=e.config,n=i.adsorbentRotations,a=i.adsorbentThreshold,o=n.length,r=0;r<o;r++){var h=n[r];if(Math.abs(h-t.rotation)<a){TweenMax.to(t,.2,{rotation:h});break}}t.rotation}},{key:"__dragSwitch",value:function(e){e?NBDrag.addDrag(this.imageBox):NBDrag.removeDrag(this.imageBox)}},{key:"__onFouce",value:function(){this.root.editor.visible=!0,this.root.imageBox.emit(e.event.ON_FOUCE,this.root)}},{key:"unFouce",value:function(){this.editor.visible=!1}},{key:"destroy",value:function(){var e=this.editor;e.children.forEach(function(t){t.removeAllListeners(),e.removeChild(t)});var t=this.imageBox;t.removeChild(e),NBDrag.removeDrag(t)}},{key:"getImageBox",value:function(){return this.imageBox}},{key:"hideHorn",value:function(){for(var e=0;e<4;e++)this.editor["horn"+e].visible=!1}},{key:"hideRotationBar",value:function(){this.editor.rotationBar.visible=!1}}]),e}();a.event={ON_FOUCE:"ImageEdit.event.ON_FOUCE",ON_CHANGE:"ImageEdit.event.ON_CHANGE"},t.default=a}});